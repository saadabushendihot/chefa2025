<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>عرض الأسئلة من قاعدة البيانات</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <!-- ملف إعدادات firebase الخاص بك -->
  <script src="firebase-config.js"></script>
  <style>
    body {font-family:'Tajawal',Arial,sans-serif;background:#f8fafc;margin:0;}
    .container {max-width:900px;margin:30px auto 0 auto;background:#fff;border-radius:12px;padding:28px 20px;box-shadow:0 2px 10px #0002;}
    h2 {color:#2260af;}
    .table-questions {width:100%;border-collapse:collapse;margin-top:15px;}
    .table-questions th,.table-questions td {border-bottom:1px solid #e4e7ef;padding:8px;text-align:center;font-size:1rem;}
    .table-questions th {background:#eef2fa;}
    .choices-list {display:flex;flex-wrap:wrap;gap:6px;justify-content:center;}
    .choice-item {background:#f5f7fb;border-radius:7px;padding:2px 10px;margin-bottom:2px;}
    .choice-item.correct {background:#e3f6ed;color:#219e4b;font-weight:bold;}
    @media (max-width:900px){.container{padding:7px;}.table-questions th,.table-questions td{padding:4px;}}
  </style>
</head>
<body>
  <div class="container">
    <h2>قائمة الأسئلة من قاعدة البيانات</h2>
    <table class="table-questions">
      <thead>
        <tr>
          <th>#</th>
          <th>السؤال</th>
          <th>المستوى</th>
          <th>الخيارات</th>
          <th>عدد الصحيحة</th>
        </tr>
      </thead>
      <tbody id="questionsTbody">
        <tr><td colspan="5">...جاري التحميل</td></tr>
      </tbody>
    </table>
  </div>

  <script>
    if (!firebase.apps.length) { firebase.initializeApp(firebaseConfig); }
    var firestore = firebase.firestore();

    function loadQuestions() {
      firestore.collection('questions').orderBy('level').get().then(snap => {
        let rows = '';
        snap.docs.forEach((doc, i) => {
          let q = doc.data();
          let chs = (q.choices || []).map((c, idx) =>
            `<span class="choice-item${q.correct && q.correct.includes(idx) ? ' correct' : ''}">${c}</span>`
          ).join('');
          rows += `<tr>
            <td>${i+1}</td>
            <td>${q.question || ''}</td>
            <td>${q.level || ''}</td>
            <td><div class="choices-list">${chs}</div></td>
            <td>${q.correct ? q.correct.length : 0}</td>
          </tr>`;
        });
        document.getElementById('questionsTbody').innerHTML = rows || `<tr><td colspan="5">لا توجد أسئلة بعد.</td></tr>`;
      }).catch(function(error){
        document.getElementById('questionsTbody').innerHTML = `<tr><td colspan="5">خطأ في تحميل الأسئلة: ${error.message}</td></tr>`;
      });
    }

    // تحميل الأسئلة عند فتح الصفحة
    loadQuestions();
  </script>
</body>
</html>
